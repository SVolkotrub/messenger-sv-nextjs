(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{7620:function(a,b,c){"use strict";var d=c(4836),e=c(5263);b.Z=void 0;var f=e(c(7294)),g=(0,d(c(2108)).default)(f.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"}),"InsertEmoticon");b.Z=g},495:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return c(831)}])},2761:function(a,b,c){"use strict";c.d(b,{Z:function(){return H}});var d={};c.r(d);var e=c(7568),f=c(1799),g=c(603),h=c(7297),i=c(4051),j=c.n(i),k=c(5893);c(7294);var l=c(9521),m=c(1197),n=c(65);c(3999);var o=c(3349),p=c(6677),q=c(6170),r=c(5321),s=c(7265),t=c(4937),u=c(1163);function v(){var a=(0,h.Z)(["\ndisplay: flex;\nalign-items: center;\ncursor: pointer;\npadding: 15px;  \nword-break: break-word;\noverflow-y: auto;\nscrollbar-width: none;\n\n:hover{\n    background-color: #e9eaeb;\n}\n"]);return v=function(){return a},a}function w(){var a=(0,h.Z)(["\nmargin: 5px;\nmargin-right: 15px;\n"]);return w=function(){return a},a}var x=function(a){var b,c,d=a.id,e=a.users,f=(0,u.useRouter)(),h=(0,g.Z)((0,o.F_)(q.I),1)[0],i=(0,r.IO)((0,r.hJ)(q.db,"users"),(0,r.ar)("email","==",(0,t.Z)(e,h))),j=(0,g.Z)((0,p.Kx)(i),1)[0],l=null==j?void 0:null===(b=j.docs)|| void 0===b?void 0:null===(c=b[0])|| void 0===c?void 0:c.data(),m=(0,t.Z)(e,h),n=function(){f.push("/chat/".concat(d))};return(0,k.jsxs)(y,{onClick:function(){return n()},children:[l?(0,k.jsx)(z,{src:null==l?void 0:l.photoURL}):(0,k.jsx)(z,{children:m[0]}),(0,k.jsx)("p",{children:m})]})},y=l.ZP.div(v()),z=(0,l.ZP)(s.Z)(w());function A(){var a=(0,h.Z)(["\nflex:0.45;\nborder-right: 1px solid whitesmoke;\nheight: 100vh;\nmin-width: 200px;\nmax-width: 350px;\noverflow-y: scroll;\n\n::-webkit-scrollbar {\n    display: none;\n}\n-ms-overflow-style: none;\nscrollbar-width: none;\n\n"]);return A=function(){return a},a}function B(){var a=(0,h.Z)(["\ndisplay: flex;\nflex-wrap: wrap;\npadding: 0px 20px;\nflex-direction: column;\nbackground-color: whitesmoke;\nz-index: 1;\n"]);return B=function(){return a},a}function C(){var a=(0,h.Z)(["\ndisplay: flex;\nmargin-top: 0;\nposition: sticky;\ntop: 0;\nbackground-color: whitesmoke;\nz-index: 1;\njustify-content: space-between;\nalign-items: center;\npadding-top:5px;\nheight: 80px;\n\n"]);return C=function(){return a},a}function D(){var a=(0,h.Z)(["\ncursor: pointer;\nheight: 40px;\nwidth: 40px;\nborder-radius: 50%;\n\n:hover{\n    opacity: 0.8;\n}\n"]);return D=function(){return a},a}function E(){var a=(0,h.Z)(["\ntext-align: left;\nword-break: break-word;\n"]);return E=function(){return a},a}function F(){var a=(0,h.Z)(["\nmargin-left:30px;\nmargin-top: 15px;\ncolor: blue;\nfont-size: 24px;\n"]);return F=function(){return a},a}function G(){var a=(0,h.Z)(["\nwidth: 100%;\nmargin-top: 10px;\nborder: 1px solid whitesmoke;\nborder-radius: 10px;\nfont-size:16px;\npadding: 8px;\npadding-left: 10px;\nbackground-color: white;\nmargin-bottom: 15px;\n\n&&& {    \n    color: black;\n    font-weight: 500;\n    text-align: left;\n    \n}\n\n"]);return G=function(){return a},a}function H(){var a,b=(0,g.Z)((0,o.F_)(q.I),1)[0],h=(0,r.hJ)(q.db,"chats"),i=(0,r.IO)(h,(0,r.ar)("users","array-contains",b.email)),l=(0,g.Z)((0,p.Kx)(i),1),s=l[0],t=null==s?void 0:s.docs.map(function(a){return(0,f.Z)({id:a.id},a.data())}),v=function(a){return null==t?void 0:t.find(function(c){return c.users.includes(b.email)&&c.users.includes(a)})},w=(a=(0,e.Z)(j().mark(function a(){var d,e;return j().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=prompt("Please enter an email address for the user you wish to chat with")){a.next=3;break}return a.abrupt("return",null);case 3:if(!((e=c(3999)).validate(d)&&d!==b.email&&!v(d))){a.next=7;break}return a.next=7,(0,r.ET)((0,r.hJ)(q.db,"chats"),{users:[b.email,d]});case 7:case"end":return a.stop()}},a)})),function(){return a.apply(this,arguments)}),y=(0,u.useRouter)(),z=function(){(0,n.w7)(q.I),y.push("/")};return(0,k.jsxs)(I,{children:[(0,k.jsxs)(J,{children:[(0,k.jsxs)(K,{children:[(0,k.jsx)(L,{src:b.photoURL||d.logo,onClick:z}),(0,k.jsx)(M,{children:b.displayName}),(0,k.jsx)(m.Z,{onClick:z})]}),(0,k.jsx)(O,{onClick:function(){return w()},children:"Search or start a new chat"})]}),(0,k.jsx)(N,{children:"Chats"}),null==s?void 0:s.docs.map(function(a){return(0,k.jsx)(x,{id:a.id,users:a.data().users},a.id)})]})}var I=l.ZP.div(A()),J=l.ZP.div(B()),K=l.ZP.div(C()),L=l.ZP.img(D()),M=l.ZP.h3(E()),N=l.ZP.div(F()),O=l.ZP.button(G())},831:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return ae}});var d=c(603),e=c(7297),f=c(5893),g=c(9008),h=c.n(g),i=c(7294),j=c(9521),k=c(2761),l=c(7568),m=c(1799),n=c(4051),o=c.n(n),p=c(6170),q=c(3349),r=c(1163),s=c(381),t=c.n(s);function u(){var a=(0,e.Z)([""]);return u=function(){return a},a}function v(){var a=(0,e.Z)(["\nwidth: fit-content;\npadding: 10px;\nborder-radius: 18px;\nmargin: 20px 10px 0px 10px;\nmin-width: 60px;\npadding-bottom: 10px;\nposition: relative;\ntext-align: right;\n"]);return v=function(){return a},a}function w(){var a=(0,e.Z)(["\nmargin-left:auto;\nbackground-color: lightgrey;\n"]);return w=function(){return a},a}function x(){var a=(0,e.Z)(["\nbackground-color: rgb(60,65, 83);\nopacity: 0.8;\ncolor: white;\ntext-align: left;\n"]);return x=function(){return a},a}function y(){var a=(0,e.Z)(["\nwidth: fit-content;\ncolor: gray;\npadding: 10px;\nfont-size: 10px;\nmargin: 0px 0px 10px 0px;\nposition: relative;\ntext-align: right;\nz-index: 50;\n"]);return y=function(){return a},a}function z(){var a=(0,e.Z)(["\nmargin-left: auto;\n\n"]);return z=function(){return a},a}function A(){var a=(0,e.Z)(["\ntext-align: left;\n"]);return A=function(){return a},a}var B=function(a){var b=a.user,c=a.msg,e=(0,d.Z)((0,q.F_)(p.I),1)[0],g=b===e.email?E:F,h=b===e.email?H:I;return(0,f.jsxs)(C,{children:[(0,f.jsx)(g,{children:c.message}),(0,f.jsx)(h,{children:c.timestamp?t()(c.timestamp).format("M/D/YYYY LT"):"..."})]})},C=j.ZP.div(u()),D=j.ZP.p(v()),E=(0,j.ZP)(D)(w()),F=(0,j.ZP)(D)(x()),G=j.ZP.p(y()),H=(0,j.ZP)(G)(z()),I=(0,j.ZP)(G)(A()),J=c(7620),K=c(5321),L=c(4937),M=c(6677);function N(){var a=(0,e.Z)([""]);return N=function(){return a},a}function O(){var a=(0,e.Z)(["\nposition: sticky;\nbackground-color: #F5F5F5;\nz-index: 100;\ntop: 0;\ndisplay: flex;\npadding: 11px;\nheight: 80px;\nalign-items: center;\nborder-bottom: 1px solid whitesmoke;\n\n"]);return O=function(){return a},a}function P(){var a=(0,e.Z)(["\ncursor: pointer;\nheight: 40px;\nwidth: 40px;\nborder-radius: 50%;\n"]);return P=function(){return a},a}function Q(){var a=(0,e.Z)(["\nmargin-left: 10px;\n"]);return Q=function(){return a},a}function R(){var a=(0,e.Z)(["\npadding: 30px;\nbackground-color: #FAFAFA;\nmin-height: 90vh;\n"]);return R=function(){return a},a}function S(){var a=(0,e.Z)([""]);return S=function(){return a},a}function T(){var a=(0,e.Z)(["\ndisplay: flex;\nalign-items: center;\npadding: 10px;\nposition: sticky;\nbottom: 0;\nborder: 0;\nbackground-color: white;\nz-index: 100;\n"]);return T=function(){return a},a}function U(){var a=(0,e.Z)(["\nflex:1;\noutline: 0;\nborder: none;\nborder-radius: 10px;\nbackground-color: white;\npadding: 20px;\nmargin-left: 15px;\nmargin-right: 15px;\n"]);return U=function(){return a},a}var V=function(a){var b,c,e=(0,d.Z)((0,q.F_)(p.I),1)[0],g=(0,i.useRef)(null),h=(0,i.useState)(""),j=h[0],k=h[1],n=(0,r.useRouter)().query.id,s=(0,L.Z)(null===(b=a.chat)|| void 0===b?void 0:b.users,e),t=(0,d.Z)((0,M.d4)((0,K.hJ)(p.db,"users")),1)[0],u=null==t?void 0:t.filter(function(a){return a.email===s})[0],v=(c=(0,l.Z)(o().mark(function a(b){var c;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b.preventDefault(),c=(0,K.JU)(p.db,"users",e.uid),(0,K.pl)(c,{lastSeen:(0,K.Bt)()},{merge:!0}),a.next=5,(0,K.ET)((0,K.hJ)(p.db,"chats/".concat(n,"/messages")),{userName:e.displayName,message:j,user:e.email,timestamp:(0,K.Bt)(),photoURL:e.photoURL});case 5:k(""),w();case 7:case"end":return a.stop()}},a)})),function(a){return c.apply(this,arguments)}),w=function(){g.current.scrollIntoView({behavior:"smooth",block:"start"})};return(0,f.jsxs)(W,{children:[(0,f.jsxs)(X,{children:[(0,f.jsx)(Y,{src:null==u?void 0:u.photoURL}),(0,f.jsxs)(Z,{children:[" ",null==u?void 0:u.userName," "]})]}),(0,f.jsxs)($,{children:[function(){if(a.messages){var b;return null===(b=a.messages)|| void 0===b?void 0:b.map(function(a){var b,c,d;return(0,f.jsx)(B,{user:a.user,msg:(c=(0,m.Z)({},a),d={timestamp:null===(b=a.timestamp)|| void 0===b?void 0:b.toDate().getTime()},d=null!=d?d:{},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(d)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(d)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(d,a))}),c)},Math.random())})}}(),(0,f.jsx)(_,{ref:g})]}),(0,f.jsxs)(aa,{children:[(0,f.jsx)(J.Z,{}),(0,f.jsx)(ab,{value:j,onChange:function(a){return k(a.target.value)}}),(0,f.jsx)("button",{hidden:!0,disabled:!j,type:"submit",onClick:v,children:"Send message"})]})]})},W=j.ZP.div(N()),X=j.ZP.div(O()),Y=j.ZP.img(P()),Z=j.ZP.h3(Q()),$=j.ZP.div(R()),_=j.ZP.div(S()),aa=j.ZP.form(T()),ab=j.ZP.input(U());function ac(){var a=(0,e.Z)(["\n  display: flex;\n"]);return ac=function(){return a},a}function ad(){var a=(0,e.Z)(["\nflex:1;\noverflow: scroll;\nheight: 100vh;\n\n::-webkit-scrollbar {\n    display: none;\n}\n-ms-overflow-style: none ;\nscrollbar-width: none;\n"]);return ad=function(){return a},a}var ae=function(){var a=(0,d.Z)((0,q.F_)(p.I),1)[0],b=(0,r.useRouter)().query.id,c=(0,K.hJ)(p.db,"chats/".concat(b,"/messages")),e=(0,K.IO)(c,(0,K.Xo)("timestamp","asc")),g=(0,d.Z)((0,M.d4)(e),1),i=g[0],j=(0,d.Z)((0,M.Xi)((0,K.JU)(p.db,"chats",b)),1),l=j[0];return(0,f.jsxs)(af,{children:[(0,f.jsx)(h(),{children:(0,f.jsxs)("title",{children:["Chat with ",(0,L.Z)(null==l?void 0:l.users,a)]})}),(0,f.jsx)(k.Z,{}),(0,f.jsx)(ag,{children:(0,f.jsx)(V,{chat:l,messages:i})})]})},af=j.ZP.div(ac()),ag=j.ZP.div(ad())},4937:function(a,b){"use strict";var c=function(a,b){return null==a?void 0:a.filter(function(a){return a!==(null==b?void 0:b.email)})[0]};b.Z=c}},function(a){a.O(0,[885,60,774,888,179],function(){var b;return a(a.s=495)}),_N_E=a.O()}])